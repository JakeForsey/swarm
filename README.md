# Swarm

A fast (GPU accelerated) two player swarm based environment with a large number of unique agents generated by LLMs.

## Usage

### 1. Run a Round Robin Tournament
```bash
python  -m swarm tournament
```

```bash
              simple reward: 0.80
              center reward: 0.70
        health_swarm reward: 0.63
        hunter_swarm reward: 0.56
        vibevolve_v1 reward: 0.48
      predator_swarm reward: 0.44
     vortex_swarm_v2 reward: 0.39
       predator_boid reward: 0.28
         param_swarm reward: 0.26
        spiral_swarm reward: 0.17
         squad_swarm reward: 0.17
        vortex_swarm reward: 0.17
        pincer_swarm reward: 0.15
        center_swarm reward: 0.07
      adaptive_swarm reward: -0.02
      fortress_swarm reward: -0.07
       concave_swarm reward: -0.11
      tactical_swarm reward: -0.11
                boid reward: -0.22
         train_swarm reward: -0.30
               pairs reward: -0.35
          smart_boid reward: -0.35
            clusters reward: -0.46
          ring_swarm reward: -0.48
        static_swarm reward: -0.54
             fleeing reward: -0.56
              chaser reward: -0.76
              random reward: -0.93
```

### 2. Animate a game between two agents
```bash
python -m swarm animate <agent1> <agent2>
```

<img src=results/animations/random_vs_predator_swarm.gif width="300px" height="300px">

### 3. Automatically code agents
```bash
python -m swarm vibe
```

### 4. **MAP Elites style prompt evolution**
```bash
python -m swarm vibevolve
```

### 5. **Train an LLM to write agents with GRPO**
```bash
python -m swarm rl
```

## Example matches

<img src=results/animations/vibevolve_v1_vs_hunter_swarm.gif width="300px" height="300px">&nbsp;<img src=results/animations/health_swarm_vs_vortex_swarm.gif width="300px" height="300px">
<img src=results/animations/health_swarm_vs_random.gif width="300px" height="300px">&nbsp;<img src=results/animations/random_vs_health_swarm.gif width="300px" height="300px">
<img src=results/animations/health_swarm_vs_vortex_swarm.gif width="300px" height="300px">&nbsp;<img src=results/animations/vibevolve_v1_vs_simple.gif width="300px" height="300px">
<img src=results/animations/vibevolve_v1_vs_fortress_swarm.gif width="300px" height="300px">&nbsp;<img src=results/animations/predator_swarm_vs_fortress_swarm.gif width="300px" height="300px">

See more in [results/animations](results/animations)
